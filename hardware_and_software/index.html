



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Hardware and Software - Password Thing</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Password Thing" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Password Thing
            </span>
            <span class="md-header-nav__topic">
              
                Hardware and Software
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Password Thing" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Password Thing
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configuration/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../technical/" title="Technical" class="md-nav__link">
      Technical
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Hardware and Software" class="md-nav__link md-nav__link--active">
      Hardware and Software
    </a>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="introduction">Introduction</h1>
<p>All software, schematics, board layouts and mesh files can be found at 
https://github.com/qvdm/PasswordThing</p>
<h1 id="circuit">Circuit</h1>
<p>The circuit for the PT models U and a are shown below.  The microprocessor board 
is a generic ATmega 32U4 "Leonardo" compatible board with a micro-usb (model U) 
or  USB A (model A) connector.  The Micro USB board is often called
ProMicro, while some vendors call teh USB A board 'Beetle'. 
The boards are available from Aliexpress and other vendors.</p>
<p>Note that boards like Arduino Nano and similar, which use an Atmega 328P processor,
will not work, since the operation of the project depends on the Atmega 32U4's
ability to act as a USB HID device, emulating a keyboard. </p>
<p><img alt="PasswordThing Model U" src="../img/PWT-U.png" />
<em>PT-U circuit diagram</em></p>
<p><img alt="PasswordThing Model A" src="../img/PWT-A.png" />
<em>PT-A circuit diagram</em></p>
<p>Here are the bare boards used for the U and A versions of the project.  </p>
<p><img alt="Boards" src="../img/boards.JPG" />
<em>Boards used for model U (left) and A (right)</em></p>
<p>The peripheral components needed are:</p>
<ul>
<li>A common-anode RGB LED (you can use common cathode, but then you need to adjust the wiring and code appropriately).</li>
<li>A 270 ohm resistor for each of the R, G and B led channels. The value nay be tweaked to change brightness. </li>
<li>A monochrome LED, and another 270 ohm resistor for model U. </li>
<li>Three momentary push button switches.  </li>
<li>An optional  128x32 I2C OLED display. </li>
</ul>
<p>Note  that you would typically not wire in an OLED display for a model A
(although it is supported).  The buttons are connected to D9, D10 and D11 in
model A, as opposed to D9, D8, D7 in the  model U.  You may wish to ommit 
the middle ("Next") button on a model A, to allow the use of larger buttons, 
since a long press of "Select"  has the same functionality.  </p>
<p>Finally, the model A board has a  build-in LED on D6, so no need to connect an external 
monochrome LED.  </p>
<h1 id="assembly">Assembly</h1>
<p>The project can be assembled many ways.  A custom 3D-printed case is probably
the best solution in the long term.  </p>
<p>The photos below  show the front and back of two of my prototype model U and A
assemblies.  The "sandwhich" construction of the model U shown is very compact and allows 
the unit to be glued to your keyboard for easy access.  (Only do this at home of 
course - see the Security section in the documentation).</p>
<p>Assembled model A board.</p>
<p><img alt="Model A top" src="../img/USBA-top.JPG" />
<em>Model A top view</em></p>
<p><img alt="Model A bot" src="../img/USBA-bottom.JPG" />
<em>Model A bottom view</em></p>
<p>In this instance, I installed three buttons, but I found it akward to use.<br />
I hihgly recommend  using larger buttons, like in the model U example below,
and using only two of them (#1 and #3) .  </p>
<p>The images below show an example of an assembled model U board. </p>
<p><img alt="Model U front" src="../img/uusb_front.JPG" />
<em>Model U front view</em></p>
<p><img alt="Model U bot" src="../img/uusb_back.JPG" />
<em>Model U back view</em></p>
<h1 id="software-build">Software Build</h1>
<p>The platformio platform is recommended for compiling the code.  Ensure that
support for the Arduino Leonardo board is installed.  </p>
<p>There is a separate build specification for each of the two board types. 
Ensure that you build the correct one for your board, otherwise the 
buttons and led will not work correctly. </p>
<h1 id="documentation">Documentation</h1>
<p>This documentation was generated with mkdocs.  There is a yaml file in the root of 
the repository. </p>
<h1 id="coding-style-and-future-development">Coding Style and future development</h1>
<p>The code started off as a FreeRTOS project, written in C, which is reflected
in the lack of C++ feature usage, and some naming conventions.  FreeRTOS was 
eventually dumped to free up flash space for features, and because the
application is not time critical at all.  </p>
<p>The remnants of the RTOS origin of the code can be seen in the main 'Task'
for each major function, that is now simply periodically called in the main
loop. Works fine as it is, but there is potentially room for optimization
there.  </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../technical/" title="Technical" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Technical
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>